<link href="/common/mobiscroll.2.5.0.production/css/mobiscroll.custom-2.5.0.min.css" rel="stylesheet" type="text/css" />
<script src="/common/mobiscroll.2.5.0.production/js/mobiscroll.custom-2.5.0.min.js" type="text/javascript"></script>
<script>

$(function () {
    //alert("scroller");
    $("#date").mobiscroll().datetime({ theme: 'android-ics', display: 'bottom'});
});

function submitform()
{
    //alert("submitform");
    var mode = $("#mode").val();

    var frm = $('#dataform');
    var method = "post";
    var action = "/material/manage/savedetail";

    tinyMCE.triggerSave();
    $('#data').val(tinyMCE.activeEditor.getContent());

    //console.log(frm.serialize()); return;
    $.ajax({
        type: method,
        url: action,
        data: frm.serialize(),
        success: function (data) {
            alert(data);
            //console.log(data); return;
            if(mode == "Create")
            {
                var url = "/material/manage/";
                redirect(url);
            }
        }
    });    
}

function redirect(url) {
    window.location = url;
}
</script>
<?php
$data=$this->maindata;
$mode=$this->mode;//"Create";
$id=0;
$name="";
$spec="";
$description="";
$supplier="";
$price="";
$date="";

if($mode==="Edit")
{
$id=$data->getId();
$name=$data->getName();
//$spec=$data->getSpec();
$description=$data->getDescription();
if($data->getSupplier())
{
    $supplier=$data->getSupplier()->getName();
}
$price=$data->getPrice();
$date=$data->getOnlinedate()->format('Y/m/d');
//$date=$data->getOnlinedate()->format('Y/m/d H:i:s');
}

?>

<h3>材料添加与编辑</h3>
<form id="dataform" name="dataform">
<input type="hidden" id="data" name="data">
<input type="hidden" name="mode" id="mode" value="<?php echo $mode; ?>">
<input type="hidden" name="id" id="id" value="<?php echo $id; ?>">
<div data-role="fieldcontain">
<label for="name">Name:</label>
<input type="text" name="name" id="name" value="<?php echo $name; ?>" />
</div>
<div data-role="fieldcontain">
<label for="date">Date:</label>
<input type="text" name="date" id="date" value="<?php echo $date; ?>" />
</div>
<div data-role="fieldcontain">
<label for="price">Price:</label>
<input type="text" name="price" id="price" value="<?php echo $price; ?>" />
</div>
<div data-role="fieldcontain">
    <label for="description">材料描述:</label>
    <textarea id="description" name="description" rows="3" cols="60"  >
    <?php echo $description; ?>  
    </textarea>
</div>
<button type="button" id="submitbutton" name="submitbutton" onclick="submitform()">Submit</button>
</form>
